var admin={};admin.callback="",admin.hash="",admin.layout_slug="",admin.xhr2json=function(xhr){return xhr.responseText[0]=="{"&&xhr.responseText[xhr.responseText.length-1]=="}"||xhr.responseText[0]=="["&&xhr.responseText[xhr.responseText.length-1]=="]"?eval("("+xhr.responseText+")"):{msg:xhr.responseText}},status_code_decorator=function(a){return function(b){a(b),admin.loading.hide()}},STATUS_CODE={200:function(a){admin.panels.display("center",a.html),a.msg!=undefined&&admin.messages.alert(a.msg)},202:function(a){console.log("redirection asked :",a.location),window.location.href=a.location},400:function(a){json=admin.xhr2json(a),admin.panels.display("center",json.html),json.msg!=undefined&&admin.messages.alert(json.msg)},403:function(a){json=admin.xhr2json(a),admin.messages.alert(gettext("You don't have the right to modify this settings."))},404:function(a){json=admin.xhr2json(a),json.msg!=undefined?admin.messages.error(json.msg):admin.messages.error(gettext("Element not found."))},409:function(a){json=admin.xhr2json(a),json.msg!=undefined&&admin.messages.error(json.msg,800)},500:function(a){json=admin.xhr2json(a),json.msg!=undefined&&admin.messages.error(json.msg)}},admin.urljoin=function(a,b){if(a!=undefined&&b!=undefined){s_url=a.split("/"),s_suffix=b.split("/");var c=Array("");for(k in s_url)s_url[k]&&c.push(s_url[k]);for(k in s_suffix)s_suffix[k]&&c.push(s_suffix[k]);c.push("");return c.join("/")}return a},admin.ajax=function(a){window.location.pathname!="/"&&(a.url=admin.urljoin(window.location.pathname,a.url));if(a.statusCode!=undefined)for(key in STATUS_CODE)a.statusCode[key]==undefined&&(a.statusCode[key]=STATUS_CODE[key]);else a.statusCode=STATUS_CODE;for(key in a.statusCode)a.statusCode[key]=status_code_decorator(a.statusCode[key]);a.error=function(a,b,c){b=="error"&&c==""&&admin.messages.error("Le serveur ne r√©pond pas")},admin.loading.show(function(){$.ajax(a)})},admin.GET=function(a){a.type="GET",admin.ajax(a)},admin.POST=function(a){a.type="POST",admin.ajax(a)},admin.PUT=function(a){a.type="PUT",admin.ajax(a)},admin.DELETE=function(a){a.type="DELETE",admin.ajax(a)},admin.serialize=function(a){typeof tinyMCE!="undefined"&&(tinyMCE.triggerSave(),tinyMCE=undefined),console.log($(a).serialize());return $(a).serialize()},admin.login={show:function(){$("#ionyweb_admin_login").show("drop",{},250),$(document).keyup(function(a){a.keyCode==27&&admin.login.hide()})},connect:function(){list=admin.serialize("#ionyweb_admin_login form"),admin.POST({url:"/wa/login/",data:list,statusCode:{200:function(a){$("#ionyweb_admin_login").hide("drop",{direction:"right"},250,function(){window.location.hash="",window.location.reload()})},400:function(a){json=admin.xhr2json(a),$("#ionyweb_admin_login_error").html(json.msg)}}})},hide:function(){window.location.hash="",$("#ionyweb_admin_login").hide("drop",{direction:"right"},250)}},admin.cancel_form=function(){admin.panels.close_all(),admin.urls.hash("")},admin.logout=function(){admin.GET({url:"/wa/logout/",statusCode:{200:function(a){admin.edit.deactive(),$("#ionyweb_admin").hide("slide",function(){window.location.hash="#",window.location.reload()})}}})},admin.loading={show:function(a){a&&a(),$("#wa_panel_loading").show("fade")},hide:function(a){a&&a(),$("#wa_panel_loading").stop().hide("fade")}}